id: QnA_Relevance_llm_based_dev_test
name: QnA Relevance Evaluation
inputs:
  question:
    type: string
    default: What feeds all the fixtures in low voltage tracks instead of each light
      having a line-to-low voltage transformer?
    is_chat_input: false
  context:
    type: string
    default: Track lighting, invented by Lightolier, was popular at one period of
      time because it was much easier to install than recessed lighting, and
      individual fixtures are decorative and can be easily aimed at a wall. It
      has regained some popularity recently in low-voltage tracks, which often
      look nothing like their predecessors because they do not have the safety
      issues that line-voltage systems have, and are therefore less bulky and
      more ornamental in themselves. A master transformer feeds all of the
      fixtures on the track or rod with 12 or 24 volts, instead of each light
      fixture having its own line-to-low voltage transformer. There are
      traditional spots and floods, as well as other small hanging fixtures. A
      modified version of this is cable lighting, where lights are hung from or
      clipped to bare metal cables under tension
    is_chat_input: false
  answer:
    type: string
    default: The main transformer is the object that feeds all the fixtures in low
      voltage tracks.
    is_chat_input: false
outputs:
  gpt_relevance:
    type: object
    reference: ${concat_scores.output.gpt_relevance}
nodes:
- name: relevance_score
  use_variants: true
- name: concat_scores
  type: python
  source:
    type: code
    path: concat_scores.py
  inputs:
    relevance_score: ${relevance_score.output}
  use_variants: false
- name: aggregate_variants_results
  type: python
  source:
    type: code
    path: aggregate_variants_results.py
  inputs:
    results: ${concat_scores.output}
  aggregation: true
  use_variants: false
node_variants:
  relevance_score:
    default_variant_id: variant_0
    variants:
      variant_0:
        node:
          name: relevance_score
          type: llm
          source:
            type: code
            path: relevance_score.jinja2
          inputs:
            deployment_name: gpt-35-turbo-16k
            temperature: 0
            top_p: 1
            max_tokens: 256
            response_format:
              type: text
            presence_penalty: 0
            frequency_penalty: 0
            context: ${inputs.context}
            question: ${inputs.question}
            answer: ${inputs.answer}
          provider: AzureOpenAI
          connection: aoai
          api: chat
          module: promptflow.tools.aoai
      variant_1:
        node:
          name: relevance_score
          type: llm
          source:
            type: code
            path: relevance_score__variant_1.jinja2
          inputs:
            deployment_name: gpt-35-turbo-16k
            temperature: 1
            top_p: 1
            max_tokens: 256
            response_format:
              type: text
            presence_penalty: 0
            frequency_penalty: 0
            context: ${inputs.context}
            question: ${inputs.question}
            answer: ${inputs.answer}
          provider: AzureOpenAI
          connection: aoai
          api: chat
          module: promptflow.tools.aoai
environment:
  python_requirements_txt: requirements.txt
